\documentclass{standalone}

\input{./content/packages}
\input{./content/desgin}
\input{./content/declarations}

\begin{document}
\begin{mindmap}
  \begin{mindmapcontent}
    \node (middle) at (current page.center) {Hardware Security and Trust
      \resizebox{\textwidth}{!}{
        \begin{minipage}[t]{16cm}
          \begin{itemize}
            \item \alert{Hardware Security} goes beyond classical cryptography, does not only consider the algorithm itself, but it considers the implementation of the algorithms (e.g. AES is believed to be secure, but attacks against the implementation like the side-channel attack: power analysis are pretty successful). % It protects the implementations of cryptographic algorithms against physical attacks, side-channel attacks etc.
              % - Avoids tampering with devices
          \end{itemize}
        \end{minipage}
      }
    }
    child {
      node {Classical Cryptography
        \resizebox{\textwidth}{!}{
          \begin{minipage}[t]{12cm}
            \begin{itemize}
                \item \alert{Cryptology:} Cryptography + cryptanalysis
                \begin{itemize}
                  \item \alert{Cryptography:} Art/science of keeping message secure
                  \begin{itemize}
                    \item is about algorithms protecting secret information
                    \item \script{67}{Basic Cryptographic Scheme}
                    \item \script{68}{Formal Notation}, $E$ \alert{injective} and both setes have \alert{same cardinality}, so \alert{one-to-one}, \alert{bijective}, so it is \alert{reversable}, $D$ is the \alert{inverse function} of $E$ and by this also bijective
                    \item \script{69}{Practice: Sending and Receiving secure messages}
                  \end{itemize}
                  \item \alert{Cryptanalysis:} Art/science of breaking ciphertext
                \end{itemize}
            \end{itemize}
          \end{minipage}
        }
      }
      child {
        node {Mathematical background
          \resizebox{\textwidth}{!}{
            \begin{minipage}[t]{12cm}
              \begin{itemize}
                \item \script{131}{\alert{finite field} $(\{0, 1\}^8, +, \cdot)=GF(2^8)$}, special case of \inlinebox{Galois field} $GF(p^k)$, with a prime number $p$ and a natural number $k$, having $p^k$ elements
                \begin{itemize}
                  \item AES needs fitting definitions of $+$ and $\cdot$ on $\{0, 1\}^8$ to turn it into a \alert{finite field}. Small finite field with $256$ elements
                  \item The irreducible polynomial used in AES is part of its specification. It is $g(X) = X^8 + X^4 + X^3 + X + 1$
                  \item one needs finite field property at point where one wants to invert the MixColumn Operation, one needs the property of having multiplicative inverse, to derive inverse matrix
                \end{itemize}
                \item \script{131}{$(\mathbb{Z}/m\mathbb{Z}, +, \cdot)$} is a \alert{field} and coincides with $GF(m)$ if $m$ is a prime number, else it is a commutative ring with multiplicative identity $\overline{1}$ 
                \begin{itemize}
                  \item to be useable for AES, $m$ must be a prime number, but $2^8-1$ isn't
                  \item RSA, modulo arithmetic, calculations in the ring $(\mathbb{Z}/m\mathbb{Z}, +, \cdot)$. RSA is a huge residue class ring, $2.048$ Bits, in the order of $2^{2046}$, $m$ is product of two really huge prime numbers
                \end{itemize}
              \end{itemize}
            \end{minipage}
          }
        }
        child {
          node {Groups
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{14cm}
                \begin{itemize}
                  \item \script{133}{Definition and Example}
                  \item $(R, *)$, $R$ is a non-empty set, $*$: $R \times R \rightarrow R$ is a \alert{group} \textit{iff}
                  \begin{itemize}
                    \item $*$ is \alert{associative}
                    \item an \alert{(unique) identity element} (unit element) $n \in R$ with $a * n = n * a = a \enspace\forall a\in R$
                    \item for each $a\in R$ exists an \alert{inverse element} $a^{-1}\in R$ with $a * a^{-1} = a^{-1} * a = n$
                  \end{itemize}
                \item \alert{abelian group} \textit{iff} $*$ is commutative
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node {Fields (germ. Körper)
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item \script{139}{Definition}
                    \item $(F, +, \cdot)$, $F$ is a non-empty set, $+,\cdot$: $F \times F \rightarrow F$ is a \alert{field} \textit{iff}
                    \begin{itemize}
                      \item $(F, +)$ is an \alert{abelian group}
                      \item \alert{Multiplication} is \alert{associative}
                      \begin{itemize}
                        \item already required by \alert{abelian group} property
                      \end{itemize}
                      \item \alert{Multiplication} is \alert{commutative}
                      \begin{itemize}
                        \item already required by \alert{abelian group} property
                      \end{itemize}
                      \item $(F\setminus \{0\}, \cdot)$ is an \alert{abelian group} ($0$ is the additive identity)
                      \item \alert{Distribuitivity}
                    \end{itemize}
                  \item \alert{Difference} to \alert{commutative rings} with (multiplicative) identity: For each element of $F\setminus\{0\}$ there is a multiplicative inverse
                  \end{itemize}
                \end{minipage}
              }
            }
            child {
              node (finitefields) {Finite / Galois Fields
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{14cm}
                    \begin{itemize}
                      \item $(GF(2), +, \cdot) = (\mathbb{Z}/2\mathbb{Z}, +, \cdot)$ (or $\{0, 1\}$ with $\oplus$ as $+$ and $\wedge$ as $\cdot$)forms a field with additive identity $0$, multiplicative identity $1$ and $1$ as the multplicative inverse of $1$
                      \begin{itemize}
                        \item \script{140}{Example} 
                      \end{itemize}
                      \item \script{138}{Making $(\{0, 1\}^k, +, \cdot)$ a finite field}
                        \begin{itemize}
                          \item define addition on $(\{0,1\}^k, +, \cdot)$ as bitwise Xor
                          \begin{itemize}
                            \item Xor on $\{0,1\}$ is the same as $+$ on $GF(2) = \mathbb{Z}/2\mathbb{Z} = \{\overline{0}, \overline{1}\}$
                          \end{itemize}
                          \item definition of $\cdot$ on $\{0,1\}^k$ such that the result becomes a finite field
                          \begin{itemize}
                            \item the And operation is $\cdot$ on $GF(2)$
                            \item to be done by reduction to the consideration of so-called polynomial rings over $GF(2)$
                            \item \script{141}{Why not $\mathbb{Z}/2^k\mathbb{Z}$?}, an element that is even is not invertable, therefore can't be a field, all elements in $\overline{1}$ are odd, $a\cdot p$ is even, because $p$ is even, so it can't be in a set where all elements are odd
                          \end{itemize}
                        \end{itemize}
                    \end{itemize}
                  \end{minipage}
                }
              }
            }
          }
          child {
            node {Rings
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item \script{132}{Definition and Example}, example has 2 additional prperties that one are not required for it to be a ring
                    \item $(R, +, \cdot)$, $R$ is a non-empty set, $+,\cdot$: $R \times R \rightarrow R$ is a \alert{ring} \textit{iff}
                    \begin{itemize}
                      \item $(R, +)$ is an \alert{abelian group}
                      \item \alert{Multiplication} is \alert{associative}
                      \item \alert{Distributivity}, because commutativity of multiplication is not required for a ring and therefore one needs second version of the law of distributivity
                    \end{itemize}
                    \item \alert{commutative ring} \textit{iff} the multiplication is also commutative
                  \end{itemize}
                \end{minipage}
              }
            }
            child {
              node {Residue class ring (germ. Restklassenring)
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{14cm}
                    \begin{itemize}
                      \item \script{134}{Definitions (ff.)}
                        \begin{itemize}
                          % \item $2 \equiv 12 \mod 10 \overset{\text{mod gilt auf}}{\underset{\text{beiden Seiten}}{\Leftrightarrow}} 12 \equiv 2 \mod 2 \Leftrightarrow 12 + q_1\cdot m \equiv 2 + q_2\cdot m\Leftrightarrow 12 + 0\cdot m \equiv 2 + q_2\cdot m\Leftrightarrow 12 \equiv 2 + q_2\cdot m$
                          \item $\boxed{12 / 10 = 1 \wedge 12 \mod 10 = 2 \enspace(\text{remainder})} \Rightarrow 2 \equiv 12 \mod 10 \Leftrightarrow 2 + 1 \cdot 10 = 12 + 0 \cdot 10 \Leftrightarrow \boxed{2 + 1 \cdot 10 = 12}\Leftrightarrow 2 + 2 \cdot 10 = 12 + 1 \cdot 10$ ($12$ is the dividend, because it's larger than $2$, $0\le 2< 10$)
                          \item \underline{Division with remainder in $\mathbb{Z}$:} For each $a \in \mathbb{Z}$ there is a unique integer $r$ with $0 \le r < m$ and $a = q \cdot m + r$ for some $q \in Z$ and $m \in \mathbb{N}, m > 1$
                          \begin{itemize}
                            \item \script{134}{Terms}
                          \end{itemize}
                          \item \underline{Congruent modulo $m$:} Definition: $a, b \in Z$ are congruent modulo $m$ ($a \equiv b \mod m$) \textit{iff} $a − b = q \cdot m$ for some $q \in Z$
                            \begin{itemize}
                              \item $a \equiv b \mod m$ iff the division with remainder wrt. $m$ gives the same remainder for $a$ and $b$
                              \item \script{134}{Proof}, \underline{forward:} because $r_a = r_b$ are equal the second part reduces to $0$, \underline{backward:} because devision of remainder gives unique result, then one can conclude that $r_a = r_b$
                            \end{itemize}
                        \end{itemize}
                      \item \script{135}{Residue class with example}: The residue class of $r \in \mathbb{Z}$ with $0 \le r < m$ is the set $\overline{r} = \{a \in \mathbb{Z} a \equiv r \mod m\} = \{q \cdot m + r q \in \mathbb{Z}\}$
                        \begin{itemize}
                          \item $(\mathbb{Z}/m\mathbb{Z}, +, \cdot), \mathbb{Z}/m\mathbb{Z} = \{\overline{0}, \overline{1}, \ldots, \overline{m-1}\}$
                          \item for $a \in r$ the integer $a \mod m$ is the unique element $r$ of $\overline{r}=\overline{a}=\{0\cdot m + r, 1\cdot m + r, \ldots, a,\ldots\}=\{q\cdot m + r \mid q\in\mathbb{Z}\}$ with $0 \le r < m$ (so in the example $\overline{13} = \overline{3}$)
                          \item each $i \in \mathbb{Z}$ is in exactly one of $m$ pairwise disjoint residue classes: $\overline{0}, \overline{1}, \ldots, \overline{m-1}$
                        \end{itemize}
                      \item \script{136}{Lemma and proof}: If $a_1 \equiv a_2 \operatorname{mod} m$, $b_1 \equiv b_2 \operatorname{mod} m$ then
                        \begin{itemize}
                          \item $a_1 + b_1 \equiv a_2 + b_2 \operatorname{mod} m$
                          \item $a_1 \cdot b_1 \equiv a_2 \cdot b_2 \operatorname{mod} m$
                          \item Addition and multiplication on $\mathbb{Z}/m\mathbb{Z}$ are \alert{well-defined}, since for the result it does not matter which representatives of $a$ and $b$ are chosen
                        \end{itemize}
                      \item \script{137}{Addition and Multiplication well definied}
                      \begin{itemize}
                        \item $\overline{a} + \overline{b} = \overline{a + b}$, $\overline{a} \cdot \overline{b} = \overline{a \cdot b}$
                        \item residue class ring $(\mathbb{Z}/m\mathbb{Z}, +, \cdot)$ forms a \alert{commutative ring} with \alert{multiplicative identity} $\overline{1}$ for all $\overline{p} \in \mathbb{Z}/m\mathbb{Z}$
                        \item \underline{Example:} \alert{residue class ring:} $\mathbb{Z}/5\mathbb{Z} = \{\overline{0}, \overline{1}, \overline{2}, \overline{3}, \overline{4}\}$ and one \alert{residue class:} $\overline{2} = \{q\cdot 5 + 2 \mid q\in \mathbb{Z}\}$, if one does computation one does not handle infinite sets but handle representatives: $\overline{2} + \overline{3} + \overline{4} = \overline{2 + 3 + 4} = \overline{4}$, modulo operation gives smalled possible element in residue class
                      \end{itemize}
                    \end{itemize}
                  \end{minipage}
                }
              }
              child {
                node (polrings) {Polynomial rings over $GF(2)$
                  \resizebox{\textwidth}{!}{
                    \begin{minipage}[t]{16cm}
                      \begin{itemize}
                        \item \script{143}{$GF(2)[X]$ and $GF(2)[X]_k$ and example for addition}
                          \begin{itemize}
                            \item $F[X]$: All polynomials in one variable $X$ over the field $F$, coefficients are elements of $F$
                            \item $F[X]_n$: Subset of $F[X]$ with $deg(g) < n$ for polynomials $g$
                            \item we map $\{0,1\}^k$ bijectively to $GF(2)[X]_k$ by the mapping $\varphi(v_{k−1}, \ldots, v_0) = v_{k−1} X^{k−1} + \ldots + v_2 X^2 + v_1 X + v_0$ (in order to be able to define a \alert{multiplication} on $\{0,1\}^k$)
                            \item \script{144}{Examples}
                            \item \script{145}{Addition and Problem with Multiplication}, addition is complicated version of bitwise Xor:
                          \end{itemize}
                        \item \script{148}{Definition: Residue Class Ring Modulo a Polynomial}: $\overline{F(X)} = F[X] / g(X):=\{\overline{u(X)} \mid u(X) \in F[X]\}$
                          \begin{itemize}
                            \item \alert{residue class of $u(X)$ modulo $g(X)$}: $\overline{u(X)}:=\{v(X) \in F[X] \mid v(X) \bmod g(X)=u(X) \bmod g(X)\}$,\quad$u(X),g(X) \in F[X] \text { with } \operatorname{deg}(g(X))\geq 1$
                            \item exactly $2^k$ different residue classes modulo $g(X)\in GF(2)[X]_{k+1}$, the classes $\overline{r(X)}$ with $deg(r(X)) < k$ in the residue class ring $GF(2)[X]/g(X)$ (can choose $2$ options for every coefficient $v_{k-1}$ to $v_0$)
                            \item \script{148}{Addition and Multiplication in $F[X]/g(x)$}: $\overline{u(X)}+\overline{v(X)}:=\overline{u(X)+v(X)}$ and $\overline{u(X)} \cdot \overline{v(X)}:=\overline{u(X) \cdot v(X)}$, addition of two residue classes is just, one takes an element from the first residue class and an element from the second residue class and then applies operation and then compute the residue class what is computing the remainder modulo $g(X)$
                              \begin{itemize}
                                \item again well-defined, because it doesn't matter what representetives one chooses
                                \item \alert{bijective mapping} $\psi:\{0,1\}^k\rightarrow G F(2)[X] / g(X)$ with $\psi\left(v_{k-1}, \ldots, v_0\right)=\overline{v_{k-1} X^{k-1}+\cdots+v_2 X^2+v_1 X+v_0}$ and $g(X)\in GF(2)[X]_{k+1}$, now $\psi$ from before doesn't map to the polynomial ring, but to the residue class ring over polynomials, bar signifies the residue class ring
                                \item \alert{Addition} in $GF(2)[X]/g(X)$ \enquote{remains} bitwise Xor on $\{0,1\}^k$, because if have polynomial with degree smaller than $k$ and a polynomial with degree smaller than $k$, than the division with $g(X)$ doesn't change anything, becase we already have something smaller than $k$, so the remainder is the element itself
                                \item \script{149}{Working Multiplication in $\{0, 1\}^k$}: $\left(v_{k-1}, \ldots, v_0\right) \cdot\left(w_{k-1}, \ldots, w_0\right):=\psi^{-1}\left(\psi\left(v_{k-1}, \ldots, v_0\right) \cdot \psi\left(w_{k-1}, \ldots, w_0\right)\right)$
                                  \begin{itemize}
                                    \item multiplication in $\{0,1\}^k$ \enquote{via} multiplication in $GF(2)[X]/g(X)$, works since $GF(2)[X]/g(X)$ is closed under multiplication. So product of two bitvectors defined by using the mapping into residue classes, doing the mulitplication of residue classes and then mapping back
                                    \item \script{150}{Example}, polymomial with $X^4$ would be out of the polynomial ring with degree smaller than $k=3$, therefore consider residue classes which means one takes result and reduce by polymomial with degree $k=3$, so remainder has a degree smaller than $3$
                                  \end{itemize}
                              \end{itemize}
                            \item \script{152}{Multiplicative inverse for all elements $\ne 0$?}
                              \begin{itemize}
                                \item for $(GF(2)[X]/g(X), +, \cdot)$ to be a field, there must be multiplicative inverse for all elements $\ne 0$
                                \item if $(GF(2)[X]/g(X), +, \cdot)$ is a field, then also $(\{0, 1\}^k, +, \cdot)$
                                \item $g(X)$ must be \alert{irreducable}, intuitively means that one doesn't have a decomposition of $g(X)$ into two non-trivial factors, so if one has $g(x) = u(X)\cdot v(X)$ then either $u(X)$ or $v(X)$ have to be a field element, trivial if one of them is a field element and non-trivial if one can really decopose it two non-trivial parts, it's similiar to prime numbers, if have integer number, one can also ask whether one can decompose it into the product of two non-trivial numbers or whether for each decomposition into two factors at least one for them has to be the one, if one computes the decomposition into prime factors, one only has one prime factor, one cannot decompose the prime numbers into non-trivial factorisation
                                \item a polynomial $g(X) \in F[X]$ with $deg(g(X)) > 0$ is \alert{irreducible} \textit{iff} the following holds: If $g(X) = u(X) \cdot v(X)$ for $u(X), v(X) \in F[X]$ then $u(X) \in F$ or $v(X) \in F$
                              \end{itemize}
                          \end{itemize}
                      \end{itemize}
                    \end{minipage}
                  }
                }
                child {
                  node {Polynomial Division
                    \resizebox{\textwidth}{!}{
                      \begin{minipage}[t]{12cm}
                        \begin{itemize}
                          \item \script{146}{Example and Check}, in normal division on would substract, but since we are doing computations based on $GF(2)$, addition and substraction are the same, doing XOR and therefore each element is it's own inverse, final result as soon as remainder is smaller than divisor. If one divides by a polynomial of degree $k$, one obtains a remainder with degree smaller than $k$
                          \item \script{147}{Lemma: Division with remainder}: For $u(X)$, $g(X) \in F[X]$ with $g(X)\ne 0$ there exist unique polynomials $q(X), r(X) \in F[X]$ with $u(X) = q(X) g(X) + r(X)$ and $deg(r(X)) < deg(g(X))$ or $r(X) = 0$
                            \begin{itemize}
                              \item $u(X) \mod g(X) = r(X)$, $u(X) \operatorname{div} g(X) = q(X)$
                              \item $r(X)$ is a unique remainder
                            \end{itemize}
                        \end{itemize}
                      \end{minipage}
                    }
                  }
                }
              }
            }
          }
        }
      }
      child {
        node {Classification by way to process plaintext}
        child {
          node (streamcipher) {Stream Ciphers
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item bitwise Encryption and Decryption
                  \item \script{93}{Definition}, $Xor$ ist associative
                  \item \script{94}{Perfect encryption system if $\ldots$}
                  \item used in e.g. Red Phone between US and SU was implemented in this way
                  \item encrypt bits individually
                  \item need a method to generate key stream efficiently, starting from some “seed
                  \item usually small and fast common in embedded device
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node {Pseudo-random sequence
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item \script{95}{Random function in C-library}, fixed values for $A$, $B$ and $m$, if prefix of plain text is known as many messages start with current date or files of certain type that have a prefix, one can continue the sequence, if $m$ happens to be a prime number, then it's a field and then one can compute inverse elements of each element and then it's just a solution of an equation system, if $m$ is not a prime number, then one does not have a field, but a ring and somtimes one can not compute the inverse or the inverse is not unique and also in this case on can try to solve a equation system to compute $A$ and $B$
                    \item pseudo random functions for cryptography it might be a problem
                  \end{itemize}
                \end{minipage}
              }
            }
          }
        }
        child {
          node (blockcipher) {Block Ciphers
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item always encrypt a full block (several bits)
                  \item are common for Internet applications
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node {More Block Ciphers
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item DES (Data Encryption Standard)
                    \begin{itemize}
                      \item Predecessor of AES
                      \item Considered insecure (small key length of 56 bits)
                      \item \underline{idea to make DES more secure:} \script{129}{Triple-DES}, decryption and encryption are inverse, also for AES one could use decryption for encryption and encryption for decryption, encrypt, decrypt, encrypt ist becausse of backward compatibility, if have implementation for triple DES and someone sends text with single DES, then K1=K2 and then after 2 rounds again plain text
                    \end{itemize}
                    \item \script{129}{List of other ciphers}
                  \end{itemize}
                \end{minipage}
              }
            }
          }
          child {
            node {Block Cipher Primitives
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item \alert{Claude Shannon:} There are two primitive operations with which strong encryption algorithms can be built:
                      \begin{enumerate}
                        \item \alert{Confusion:} An encryption operation where the \alert{relationship between key and ciphertext is obscured}
                          \begin{itemize}
                            \item today, a common element for achieving confusion is substitution, which is found in AES and other ciphers.
                          \end{itemize}
                        \item \alert{Diffusion:} An encryption operation where the \alert{influence of one plaintext symbol is spread over many ciphertext symbols} with the goal of hiding statistical properties of the plaintext
                          \begin{itemize}
                            \item in other context known as Transposition
                            \item a simple diffusion element is the \alert{bit permutation} (in other context known as Tranposition)
                          \end{itemize}
                      \end{enumerate}
                      \begin{itemize}
                        \item Both operations by themselves are suboptimal in providing security. A cipher must include confusion and diffusion elements
                      \end{itemize}
                  \end{itemize}
                \end{minipage}
              }
            }
          }
        }
      }
      child {
        node {Classification by key
          % Crypto System with Keys
          \resizebox{\textwidth}{!}{
            \begin{minipage}[t]{12cm}
              \begin{itemize}
                \item \script{70}{Definition}, $E$ is a set of encryption algorithms and the key $K_E$ selects one special encryption algorithm based on the key, with each key one has a different encryption, same for $K_D$, both algorithms \alert{have to match}, they encryption key should be in a certain relation to the decrytpion key, they can also be just the same
                \item \underline{advantage of crypto systems with keys:}
                \begin{itemize}
                  \item keeping the encryption / decryption algorithm secret is not needed
                  \item keys can regulary be changed, to increase security
                \end{itemize}
              \end{itemize}
            \end{minipage}
          }
        }
        child {
          node (symmetric) {Symmetric cryptosystems $K_E = K_D$
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item encipher and decipher using the same key
                  \begin{itemize}
                    \item or one key is easily derived from the other
                  \end{itemize}
                  \item \underline{disadvantage:}
                  \begin{itemize}
                    \item one needs a \alert{key exchange}, the sender and the receiver have to agree on the same key and they key should be secret, one needs a way to transport the secret key via a secure channel from the sender to the receiver
                  \end{itemize}
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node (aes) {Advanced Encryption Standard (AES)
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item \script{101}{Properties and Backstory}, block size always the same, number of rounds depens on key length that can be different, efficiency in \textit{software} and \textit{hardware}, byte-oriented cipher to be appropriate for small microprocessors and -controlers that havea $8$-bit width in the data path
                    \item \script{102}{Iterated Cipher types}, with key lengths $128$ ($16$ Bytes), $192$, $256$ and respective numbers of rounds $10, 12, 14$ and always $+1$ subkeys respective
                    \item at the moment most widely used symmetric cipher
                    \item it is \alert{deterministic}, i.e., with the same key identical plain text blocks are mapped to the same cipher text blocks
                  \end{itemize}
                \end{minipage}
              }
            }
            child {
              node {Implementation in Software
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{12cm}
                    \begin{itemize}
                      \item straightforward implementation is well suited for $8$-bit processors (e.g., smart cards) with small amount of memory, because operations are on bytes, but inefficient on $32$-bit or $64$-bit processors
                      \item \script{121}{More sophisticated approach for $32$-bit processors explained and speed (f.)}, because operations are on bytes that is no efficient for $32$-bit processors, store all precomputed $2^8=256$ possible operation results for one column of the constant matrix in one T-Table (\href{https://crypto.stackexchange.com/questions/19175/efficient-aes-use-of-t-tables}{\inlinebox{Explanation}}), T-Table has $4$ byte entries, because e.g. the result of $T_4[FF] = 01*FF \mid 01*FF \mid 03*FF \mid 02*FF$ ($\mid$ stands for concatenation) for the last column $4$ and input $ff$ has a concatenated width of $4$ bytes, efficient on $32$-bit processor when just Xor $3$ times $4$ $32$-bit words (a T-Table entry has $4$ bytes) that one has to look up in the precomputed T-Table, for $4$ T-Tables need $4KB$%, , $4$ byte entries are depending on the plain text value, for computing one column we need $4$ table lookups and $3$ Xor additions, for complete matrix with 4 columsn one has to do it 4 times, so $4\times 4=16$ accesses to the $4$ T-tables and $4\times 3=12$ Xor operations
                      \item \underline{hardware implementation:} speed up little bit with unrolling if cost doesn't matter, if only implement one round one need some multiplexers, because key schedule generation not exactly the same for each round, multiplexers do different things depending on round number, select right subkey $k_i$
                    \end{itemize}
                  \end{minipage}
                }
              }
            }
            child {
              node {Security
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{12cm}
                    \begin{itemize}
                      \item \alert{Brute-force attack:} Due to the key length of $128$, $192$ or $256$ bits, a brute-force attack is not possible
                      \item \alert{Analytical attacks:} There is no analytical attack known that is better than brute-force
                      \item \alert{Side-channel attacks:} Several side-channel and fault-injection attacks have been published attacking the implemntation (not the algorithm)%. Note that side-channel attacks do not attack the underlying algorithm but the implementation of it
                      \item \script{124}{Remark: Importance of nonlinear S-Boxes}, several rounds also wouldn't make a problem, could still solve with linear equation system, because composition of two linears function is a linear function, composition of linear function with an addition is again just an addition
                    \end{itemize}
                  \end{minipage}
                }
              }
              child {
                node {Encrypting longer plain text
                  \resizebox{\textwidth}{!}{
                    \begin{minipage}[t]{12cm}
                      \begin{itemize}
                        \item \script{125}{Example: Image}, because it is deterministic, i.e., with the same key identical plain text blocks are mapped to the same cipher text blocks
                        \item \underline{Countermeasure:} Different modes for block ciphers
                        \begin{itemize}
                          \item \script{126}{ECB, Encryption, Decryption, Advantages, Disadvantages} = \alert{E}lectronic \alert{C}ode \alert{B}ook Mode
                          \begin{itemize}
                            \item Straightforward application of block cipher
                            \item \underline{disadvantage:} \alert{traffic analysis}, if know block with encoding of account number, without knowing how encryption works, one can replace ones own encrypted account number with account number of other account in other transmission (\alert{substituion attack})
                          \end{itemize}
                        \item \script{127}{CBC, Encryption, Decryption, Advantages, Disadvantages} = \alert{C}ipher \alert{B}lock \alert{C}haining Mode
                        \begin{itemize}
                          \item \underline{advantage:} no \alert{traffic analysis} possible
                        \end{itemize}
                        \end{itemize}
                      \end{itemize}
                    \end{minipage}
                  }
                }
              }
            }
            child {
              node {Decryption
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{14cm}
                    \begin{itemize}
                      \item \underline{\script{115}{all layers} must be inverted for decryption:} invert last round (has no MixColumn Layer), then inverse of second last round and finally inverse of first round and then additionaly invert the first key addition
                      \begin{itemize}
                        \item \script{116}{Inv MixColumn layer (f.)}, to reverse the MixColumn operation, each column of the state matrix $C$ must be multiplied with the inverse of the $4\times 4$ matrix, \script{117}{identity matrix}, all arithmetic is done in $GF(2^8)$. Useful that in the encryption one used matrix that is \alert{invertable}
                       \item \script{118}{Inv ShiftRows layer}, all rows of the state matrix B are shifted to the opposite direction (now right)
\item \alert{Inv Byte Substitution layer}, since the S-Box is bijective, it is possible to construct an inverse, such that $A_i = S^{–1}(B_i) = S^{–1}(S(A_i))$. The inverse S-Box is used for decryption. It is usually realized as a lookup table. Inverse Lookup Table easy to get from Lookup Table
                       \item \alert{Key Addition layer} is its own inverse (\script{115}{explanation})
                      \end{itemize}
                      \item \alert{Decryption key schedule}, subkeys are needed in reversed order (compared to encryption). \underline{For decryption:} Before starting decryption, first compute all subkeys from the actual key (as done for encryption) and apply in reverse order, same subkey generation as for the encryption
                    \end{itemize}
                  \end{minipage}
                }
              }
            }
            child {
              node {Round Structure and Internal Structure
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{16cm}
                    \begin{itemize}
                      \item \script{103}{Round Structure} $X$ instead of $P$, $Y$ instead of $C$. In the last round do the same omitting the MixColumn Layer (\href{https://crypto.stackexchange.com/questions/1346/why-is-mixcolumns-omitted-from-the-last-round-of-aes}{\inlinebox{reason}})
                      \item \script{104}{Internal Structure (f.)}: $16$ bytes block size, arranged in a $4x4$ matrix
                        \begin{itemize}
                          \item \alert{Byte Substitution Layer:} Don't need matrix, is done \textit{Byte by Byte}, S-Box / functions $S$ \alert{identical} for all $16$ bytes, propably to save memory, because a $S$-Boxe is usually represendet in software implementation by a \script{107}{Lookup Table} ($1$-to-$1$ mapping, so no value in the results / cells of table which occurs twice, always the same lookup table for all implementations for AES, it is part of the specification of AES) with input values $0$ to $2^8-1 = 255$ (\script{106}{reference}), S-Boxes are the only \alert{nonlinear} ($ByteSub(A_i) \oplus ByteSub(A_j) \ne ByteSub(A_i \oplus A_j)$) elements of AES and they are \alert{bijective}, i.e. a $1$-to-$1$ mapping of input and output bytes. Can also be described as computing the multiplicative inverse in $GF(2^8)$. Because of the nonlinaer elements, the S-Boxes one can't use that there's a connection between plaint text and cipher text because of linearity
                          \item \alert{Diffusion Layer:}  Provides diffusion over all input state bits. Performs a linear operation on state matrices A and B, i.e., $DIFF(A) \oplus DIFF(B) = DIFF(A \oplus B)$
                            \begin{itemize}
                              \item \script{109}{ShiftRows Layer}: Permutation of the data on a \alert{byte level}. Rows of the state matrix are shifted cyclically
                              \item \script{110}{MixColumn Layer}: Matrix operation which combines (\enquote{mixes}) blocks of $4$ bytes. Can't be decribed by permutation of Bytes or Bits, the input can have more or less bits equal to $1$ then the output. Linear transformation which mixes each column of the state matrix. Each $4$-byte column is considered as a vector and multiplied by a fixed $4\times 4$ matrix. All arithmetic is done in the \alert{Galois field} $GF(2^8)$, where $GF(2^8)$ is $\{0, 1\}^8$ with addition as bitwise $Xor$ and an \enquote{appropriate} multiplication. Boxes are \alert{identical} for all terms, so one does multiplication with the same matrix and this matrix is fixed for AES. This matrix needs to have the property of being \alert{invertable}
                            \end{itemize}
                          \item \script{111}{Key Addition Layer}: Bitwise Xor, in round number $i$ one \enquote{adds} the $16$-byte \alert{state matrix} $C = C_0C_1\ldots C_{15}$ with the $16$-byte \alert{subkey / round key} $k_i$: $C \oplus k_i$. The subkeys are generated in the \alert{key schedule}, they are derived from the original key $k$. Is the only part that depends on the key and everything is else is to hide what one did and make the decryption without knowing the key much more difficult, such that it's never much simpler than a brute-force attack for which the number of keys is too large.
                            \begin{itemize}
                              \item \script{113}{Key Schedule (pr.,f.)}, subkeys are derived recursively from the original 128/192/256-bit input key, $\#subkeys = \#rounds + 1$, each round has $1$ subkey, plus $1$ subkey at the beginning of AES. \alert{Key whitening:} Subkey is used both at the input and output of AES. There are different key schedules for the different key sizes. Called subkeys, because for key-length 192 and 256 they are subkeys, for 128 too even though it doesn't make sense to call them subkeys. The only really random part os the original key. The round key number $0$ is the original key. If one would also do it the same for the first, one would have a cyclic dependency. For round key $2$ its almost the same with the difference, that in the different rounds the $g$ functions are slightly different. \script{114}{Function $g$} rotates its four input bytes and performs a bytewise S-Box substitution (\textit{the same} as before) $\rightarrow$ nonlinearity. The \alert{round coefficient} RC is only added to the leftmost byte and \textit{varies from round to round}. Until $RC[8]$ it is leftshift, then one can't shift anymore and chooses elements of the Galois field again. \underline{Hint:} Multiplication in Galois field has something to do with multiplicatin of polynomials. Only on byte where on adds this $RC[i]$. $x_i$ represents an element in the Galois field $GF(2^8)$
% , in each round transformation of the original key, for keywidth 128 one has $10$ rounds and for them one needs $11$ round keys derived from the secret key $k$, 
                            \end{itemize}
                        \end{itemize}
                    \end{itemize}
                  \end{minipage}
                }
              }
            }
          }
        }
        child {
          node (asymmetric) {Asymmetric cryptosystems $K_E \ne K_D$
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item ecncipher and decipher using different keys
                  \begin{itemize}
                    \item computationally infeasible to derive one from other
                    % \item it should be computationally infeasible in reasonable time to derive one private key from the public key
                  \end{itemize}
                  \item \underline{advantages:}
                    \begin{itemize}
                      \item allows to share public key, secure key exchange not needed (for \alert{confidentiality}, message should be kept secret)
                      \item also other applications like authentication (\alert{authenticity}, able to sign message, so it can be sure it can only come from oneself)
                    \end{itemize}
                \end{itemize}
              \end{minipage}
            }
          }
        }
      }
      child {
        node {Classification by type of encryption operations}
        % Basic Types of Ciphers
        child {
          node (substitution) {Substitution ciphers
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item letters of $P$ replaced with other letters by $E()$
                  \item \underline{effects:}
                  \begin{itemize}
                    \item $C$ hides chars of $P$ (plaintext)
                    \item if $> 1$ key alphabet (polyalphabetic), $C$ dissipates high frequency chars
                  \end{itemize}
                  \item \underline{Sidenote:} One can say $key = 3$ or $key = \enquote{D}$, because $no(D) = 3$
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node {Monoalphabetic substitution ciphers
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{10cm}
                  \begin{itemize}
                    \item in a general monoalphabetic substitution cipher each letter in $P$ is substituted by a fixed letter using a \alert{substitution table}
                    \item the \alert{key} is the substitution table
                    \begin{itemize}
                      \item there are $26 \times 25 \times \ldots \times 3 \times 2 \times 1 = 26! \approx 2^{88}$ substitution tables ($=$ keys) as depicted \script{78}{here (f.)}, because the mapping has to be injective
                    \end{itemize}
                    \item \underline{Attacks:}
                    \begin{itemize}
                      \item \script{79}{Exhaustive search}, Brute-force attack is not feasible
                      \item \script{80}{Letter Frequency Analysis (ff.)}: Statistical analysis
                      \begin{itemize}
                        \item In practice, not only frequencies of individual letters can be used for an attack, but also the frequency of letter pairs (i.e., \enquote{TH} is very common in English), letter triples, etc
                        \item need better concealing of statistical frequencies and probably also longer keys to avoid exhaustive search $\rightarrow$ Polyalphabetic substitution ciphers
                      \end{itemize}
                    \end{itemize}
                  \end{itemize}
                \end{minipage}
              }
            }
            child {
              node {Caesar Cipher
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{12cm}
                    \begin{itemize}
                      \item \script{74}{Defintion (f.)}, example key is $3$
                      \item each letter in $P$ is substituted by a fixed letter. In this special case the \enquote{key} is of length $1$, it is the shift amount
                      \item \script{76}{Attack: Exhaustive search}
                    \end{itemize}
                  \end{minipage}
                }
              }
            }
          }
          child {
            node {Polyalphabetic substitution ciphers
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item \script{84}{Definition (f.)}
                    \item several key alphabets, flatten (diffuse) somewhat the frequency distribution of letters by combining high and low distributions
                    \item \underline{Attack:} If one knows the $n$, then one can break the whole text into $n$ parts and for these a statistical analysis works as for the monialphabetic substitution cipher with the unigram model
                    \begin{itemize}
                      \item only works if the attacker doesn't know the algorithm, this is not optimal, because one has to hide the algorithm or consider this $n$ also as part of the key, but then $n$ has to be very large to avoid a brute-force attack. Pairs are not hidden, but the unigram attack still works (\script{86}{summary here})
                    \end{itemize}
                  \end{itemize}
                \end{minipage}
              }
            }
            child {
              node (viginere) {Vigenère Tableaux Method
                \resizebox{\textwidth}{!}{
                  \begin{minipage}[t]{12cm}
                    \begin{itemize}
                      \item \script{87}{Definition (ff.)}
                      \item special case of polyalphabetic substitution with $n$ key alphabets. For each key alphabet the special case of Caesar cipher is chosen, i.e., each key alphabet can be represented by one letter
                      \item \script{88}{Tableaux}: rows are possible key characters and the columns give the encoding
                      \begin{itemize}
                        \item one can describe a row either by the shift or by saying which letter $c_i$ it mapped to which letter $c_j$ and takes $b_j$ as name of the row, choosing the last choice one can describe $n$ keys by a word of length $n$ 
                      \end{itemize}
                      \item \script{89}{Example}
                      \item $26^n$ different keys, one has to choose $n$ large enough
                      \item \alert{Attack:}
                      \begin{itemize}
                        \item same problem as for polyalphabetic substitution ciphers
                      \end{itemize}
                      \item \script{97}{Classification}
                    \end{itemize}
                  \end{minipage}
                }
              }
            }
          }
        }
        child {
          node (transposition) {Transposition (permutation) ciphers
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item order of letters in $P$ rearranged by $E()$
                  \begin{itemize}
                    \item rearrange letters in plaintext to produce ciphertext
                  \end{itemize}
                  \item \script{90}{Example}
                  \item \underline{effects:}
                  \begin{itemize}
                    \item $C$ scrambles text, hides $n$-grams for $n > 1$ (combinations of $n$ letters, e.g. th)
                  \end{itemize}
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node {Rail-Fence Cipher
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item columnar transposition
                    \item \script{90}{Example}
                    \item Key = Number of columns
                    \item \underline{Attack:} Number of columns / the  key space is restricted if the text is short
                  \end{itemize}
                \end{minipage}
              }
            }
          }
        }
        child {
          node (product) {Product ciphers
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item combine two or more ciphers to enhance the security of the cryptosystem
                  \begin{itemize}
                    \item $E = E_1 + E_2 + ... + E_n$
                    \item built of multiple blocks, either \alert{Substitution} or \alert{Transposition}
                  \end{itemize}
                  \item \underline{attack}:
                  \begin{itemize}
                    \item product cipher might not necessarily be stronger than its individual components used separately, \script{91}{Example}
                  \end{itemize}
                  \item \underline{effects:}
                  \begin{itemize}
                    \item can do all what Substitution and Transposition ciphers can so, more secure if used well
                  \end{itemize}
                \end{itemize}
              \end{minipage}
            }
          }
          child {
            node {Two-block product cipher
              \resizebox{\textwidth}{!}{
                \begin{minipage}[t]{12cm}
                  \begin{itemize}
                    \item $E2(E1(P, KE1), KE2)$
                    \item may be repeated to form several encryption rounds
                  \end{itemize}
                \end{minipage}
              }
            }
          }
        }
      }
    }
    child {
      node (test){Basics}
      child {
        node {Security
          \resizebox{\textwidth}{!}{
            \begin{minipage}[t]{12cm}
              \begin{itemize}
                \item \alert{Security:} No complete definition. Could define it as ability to satisfy certain security properties (\script{13}{more precise})
                  \begin{itemize}
                    \item tampering can be conducted at all levels, hardware is not a root of trust, one only can't change it afterwards
                    \item is also a matter of cost, most secure system is a system that doesn't do anything (don't grant access to anybody), but the system also has to be useful, not to expensive etc. (power, area, price and performance). Security processing may add considerable overhead to a resource-constrained embedded system. Only on componentn in a optimzation problem which optimizes the cost of the whole system. Today’s security features can be attacked by tomorrow’s technology
                  \end{itemize}
                \item \alert{Safety:} System is designed without any error leading to unintended behavior (\alert{design time})
                \item \alert{Reliability:} A correctly designed system continues to work correctly during its \alert{life-time}
              \end{itemize}
            \end{minipage}
          }
        }
        child {
          node {Possible Actions of Adversaries, Attacks (ff.)
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item \alert{side-channel attack:} using sidechannel outputs to extract information, when a chip works it produces more information that occurs on the outputs, measure e.g. energy consumption, electromagnetic field etc. (focuses on \alert{outputs}, i.e. side-channels)
                  \item \alert{fault injection:} counterpart to side-channel, focuses on \alert{additional inputs}, e.g. shooting with a laser beam on certain point in a chip which causes a fault and from the effect of this fault one can derive secret information
                    \begin{itemize}
                      \item \script{23}{Example: Power Analysis}
                    \end{itemize}
                    % using outputs of chip that are not the usual outputs, 
                  \item \script{25}{Example for attacked device: Smart Card}, weak 8-Bit CPU, because of cost, not best encryption methods, easy to get physical access
                  \item \script{26}{Example for attacked device: RFID}, even weaker IC, then on Smart Cards
                  \item \script{35}{Countermeasures}
                \end{itemize}
              \end{minipage}
            }
          }
        }
        child {
          node {Related Terms
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item \alert{Vulnerability:} Weakness in the secure system
                  \item \alert{Threat:} Set of circumstances that has the potential to cause loss or harm
                  \item \alert{Attack:} The act of a human exploiting the vulnerability in the system
                    \begin{itemize}
                      \item \script{16}{relationship security vs. safety and reliability}
                    \end{itemize}
                \end{itemize}
              \end{minipage}
            }
          }
        }
        child {
          node {Security properties (\script{14}{\enquote{CIAAN}})
            \resizebox{\textwidth}{!}{
              \begin{minipage}[t]{12cm}
                \begin{itemize}
                  \item \alert{Confidentiality:} Protecting confidential information from being disclosed to unauthorized parties.
                    \begin{itemize}
                      \item no unauthorized reads
                    \end{itemize}
                  \item \alert{Integrity:} Ensuring that information is only modified by authorized parties.
                    \begin{itemize}
                      \item no unauthorized writes
                    \end{itemize}
                  \item \alert{Availability:} Making sure that information and systems are accessible to authorized parties when they need them
                    \begin{itemize}
                      \item e.g. resistance to denial-of-service attacks
                    \end{itemize}
                  \item \alert{Authenticity:} Ensuring that information and communication come from the source they are supposed to come from.
                    \begin{itemize}
                      \item receiver of email knows for sure it comes from you, achieved by e.g. digital signatures
                    \end{itemize}
                  \item \alert{Non-repudiation:} Ensuring that nobody can deny having performed certain actions (like sending / receiving messages, changing data etc.).
                    \begin{itemize}
                      \item access to system is protected by login and logging when changing file
                    \end{itemize}
                \end{itemize}
              \end{minipage}
            }
          }
        }
      }
      child {
        node {Design Cycle and Threats
          \resizebox{\textwidth}{!}{
            \begin{minipage}[t]{12cm}
              \begin{itemize}
                \item \script{41}{Traditional Design Cycle of ICs}
                \item \alert{Problems:}
                \begin{itemize}
                  \item \script{42}{Problem 1 (f.)}: \alert{Cost of Manufacturing}, \textit{\enquote{fabless} companies}, \script{44}{untrusted foundry (pr.)}, \script{47}{untrusted assembly (pr.}, can mark corrects IC's as devective and sell them, fab doesn't know exactly fraction of devective to total)
                  \item \script{48}{Problem 2}: \alert{Design Complexity}, Company that provides \textit{IP} (intellectual property) block can be untrusted
                \end{itemize}
                \item \script{50}{New Design Cycle of ICs}, Vendors of IP Blocks not trusted, safety (not part of this lecture) and security problem, \alert{Soft IP}: Buying \textit{RTL} (Register transfer level) designs, \alert{Firm IP}: Buying \textit{Gate Level Netlists}, \alert{Hard IP}: Integrating \textit{Layout Data} bought by another company, IP Vendors would not give all information about IP how they came to this layout because it could also not trust, because one could steal it's IP, both sides have to trust, one needs methologies that ensure that IP does the right thing and on the other hand that the person who bought it, is not able to steal it
                \item \script{53}{Vulnerabilities and untrusted parties}, \alert{IC Piracy} is overproduction, selling devective \textit{out-of-spec} IC's etc., \script{58}{Counterfeiting}, \textit{Cloned IC's} when somoeone steals design data or reverse engineering, \script{59}{IC recyling}, Problem because of \alert{Bathtub Curve}
                \item \script{60}{Overview: Supply Chain Vulnerabilities}, \alert{Remark} e.g. weak processor by the name of a much better proecessor, at all points of the supply chain there are threats for the hardware security
              \end{itemize}
            \end{minipage}
          }
        }
      }
    }
  \end{mindmapcontent}
  \begin{edges}
    \edge{viginere}{blockcipher}
    \edge{aes}{product}
    \edge{aes}{blockcipher}
    \edge{finitefields}{polrings}
  \end{edges}
  \annotation{test}{annotation}
\end{mindmap}
\end{document}
